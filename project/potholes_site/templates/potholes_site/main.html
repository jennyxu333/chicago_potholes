{% extends 'potholes_site/base.html' %}

{% block body %}

    <h1> Chicago Pothole Repair Tracker </h1>
    <h3>Filter Search:</h3>

    <table>{{ model }}</table>

    <p><a href="{% url 'stats' %}">Compare across Chicago neighborhoods</a></p>

    <head>
        <style>
            #map {
                width: 600px;
                height: 500px;
                background-color: #CCC;
            }
        </style>
    </head>
        <body>
            <div id="map"></div>
            <script>
            function initMap() {
                var mapDiv = document.getElementById('map');
                var map = new google.maps.Map(mapDiv, {
                    center: {lat: 44.540, lng: -78.546},
                    zoom: 14
                    });
                var infoWindow = new google.maps.InfoWindow({map: map});

                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(function(position) {
                        var pos = {
                            lat: position.coords.latitude,
                            lng: position.coords.longitude
                        };
                        infoWindow.setPosition(pos);
                        infoWindow.setContent('Location found.');
                        map.setCenter(pos);
                    }, function() {
                        handleLocationError(true, infoWindow, map.getCenter());
                    });

                } else {
                    // Browser doesn't support Geolocation
                    handleLocationError(false, infoWindow, map.getCenter());
                }
            }

            function handleLocationError(browserHasGeolocation, infoWindow, pos) {
                infoWindow.setPosition(pos);
                infoWindow.setContent(browserHasGeolocation ?
                        'Error: The Geolocation service failed.' :
                        'Error: Your browser doesn\'t support geolocation.');
            }
    
            </script>
            <script src="https://maps.googleapis.com/maps/api/js?callback=initMap"
            async defer></script>
        </body>


{% endblock %}